@startuml DER
!theme plain
skinparam linetype ortho

entity "Usuario" {
    * id : INT <<PK>>
    --
    * email : VARCHAR(255)
    * senha_hash : VARCHAR(255)
    * tipo_usuario : ENUM
    * ativo : BOOLEAN
    * data_criacao : TIMESTAMP
    * ultimo_acesso : TIMESTAMP
}

entity "Paciente" {
    * id : INT <<PK>>
    * usuario_id : INT <<FK>>
    --
    * nome : VARCHAR(255)
    * cpf : VARCHAR(14)
    * data_nascimento : DATE
    * telefone : VARCHAR(20)
    * endereco : TEXT
    * cep : VARCHAR(10)
    * cidade : VARCHAR(100)
    * estado : VARCHAR(2)
    * plano_saude : VARCHAR(100)
    * numero_carteirinha : VARCHAR(50)
}

entity "Profissional" {
    * id : INT <<PK>>
    * usuario_id : INT <<FK>>
    --
    * nome : VARCHAR(255)
    * cpf : VARCHAR(14)
    * crm_crn : VARCHAR(20)
    * especialidade : VARCHAR(100)
    * telefone : VARCHAR(20)
    * email : VARCHAR(255)
    * ativo : BOOLEAN
}

entity "Consulta" {
    * id : INT <<PK>>
    * paciente_id : INT <<FK>>
    * profissional_id : INT <<FK>>
    --
    * data_hora : TIMESTAMP
    * tipo : ENUM
    * status : ENUM
    * observacoes : TEXT
    * valor : DECIMAL(10,2)
}

entity "Prontuario" {
    * id : INT <<PK>>
    * paciente_id : INT <<FK>>
    * profissional_id : INT <<FK>>
    --
    * data_atendimento : TIMESTAMP
    * anamnese : TEXT
    * diagnostico : TEXT
    * conduta : TEXT
    * observacoes : TEXT
}

entity "Prescricao" {
    * id : INT <<PK>>
    * prontuario_id : INT <<FK>>
    * profissional_id : INT <<FK>>
    --
    * data_prescricao : TIMESTAMP
    * medicamentos : TEXT
    * dosagem : TEXT
    * observacoes : TEXT
    * valido_ate : DATE
}

entity "Exame" {
    * id : INT <<PK>>
    * paciente_id : INT <<FK>>
    * profissional_id : INT <<FK>>
    --
    * tipo_exame : VARCHAR(100)
    * data_solicitacao : TIMESTAMP
    * data_realizacao : TIMESTAMP
    * resultado : TEXT
    * arquivo : VARCHAR(255)
    * status : ENUM
}

entity "Leito" {
    * id : INT <<PK>>
    --
    * numero : VARCHAR(10)
    * setor : VARCHAR(100)
    * tipo : ENUM
    * status : ENUM
    * paciente_id : INT <<FK>>
    * data_ocupacao : TIMESTAMP
}

entity "Internacao" {
    * id : INT <<PK>>
    * paciente_id : INT <<FK>>
    * leito_id : INT <<FK>>
    * profissional_id : INT <<FK>>
    --
    * data_entrada : TIMESTAMP
    * data_saida : TIMESTAMP
    * diagnostico : TEXT
    * status : ENUM
    * observacoes : TEXT
}

entity "Suprimento" {
    * id : INT <<PK>>
    --
    * nome : VARCHAR(255)
    * categoria : VARCHAR(100)
    * quantidade_atual : INT
    * quantidade_minima : INT
    * unidade_medida : VARCHAR(20)
    * fornecedor : VARCHAR(255)
    * ultima_compra : DATE
}

entity "Auditoria" {
    * id : INT <<PK>>
    * usuario_id : INT <<FK>>
    --
    * data_hora : TIMESTAMP
    * acao : VARCHAR(100)
    * modulo : VARCHAR(100)
    * detalhes : TEXT
    * ip_address : VARCHAR(45)
}

' Relacionamentos
Usuario ||--o| Paciente : "tem"
Usuario ||--o| Profissional : "tem"
Paciente ||--o{ Consulta : "possui"
Profissional ||--o{ Consulta : "atende"
Paciente ||--o{ Prontuario : "possui"
Profissional ||--o{ Prontuario : "cria"
Prontuario ||--o{ Prescricao : "contém"
Profissional ||--o{ Prescricao : "emite"
Paciente ||--o{ Exame : "realiza"
Profissional ||--o{ Exame : "solicita"
Leito ||--o| Internacao : "hospeda"
Paciente ||--o{ Internacao : "internado"
Profissional ||--o{ Internacao : "responsável"
Usuario ||--o{ Auditoria : "gera"

@enduml

